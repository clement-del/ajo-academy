[home](README.md)

<p align="center">
<img width="800" src="https://github.com/user-attachments/assets/9c94e953-ab53-4ff6-b4f2-c6e5ea244489" />
</p>


Adobe Journey Optimizer (AJO) is your one stop shop for creating seamless, 1:1 omnichannel experiences. By listening to real-time customer interaction or location events you can now orchestrate 1:1 journeys, leveraging the Real-time Customer Profile along with optional external data sources to deliver the right message within the right channel at the right time.


Let's begin first with a quick tour of the AJO user interface

---
# The Journey Optimizer User Interface
AJO menu gives access to everything you need to power your customer experiences: Marketing Campaigns, User Journeys, Offer Engine, Landing Pages, Audiences and much more. Menu items are configurable based on access rights, here you can see (almost) all the menu entries. You can also access all the items through the quick search bar
<img width="790" alt="image" src="https://github.com/user-attachments/assets/ac78bf46-df10-4616-9d8d-94d8ec661563" />


AJO also comes with a conversational agent called AI Assistant you can use by clicking on the icon in the top right hand corner <img width="46" alt="image" src="https://github.com/user-attachments/assets/c61c2aa7-e83f-4d6f-85b7-228f4df975eb" />. There you can ask ny questions related to the product itself (eg: What are the best practices for testing and publishing a landing page?) or to get insights about your data (eg: identify the most used journey and assess any performance indicators)
<img width="481" alt="image" src="https://github.com/user-attachments/assets/ed5ea43c-a291-4d68-8722-46b56ec44112" />


In this chapter, you are going to build your own version of the Luma Purchase Journey where we'll provide the logic to listen and react to Luma customer interactions during the checkout process. 
- Under _Journey management_ menu, click on _Journeys_ 
- In the _Browse_ tab, click _Create Journey_
- Name your journey _Purchase Journey_, please prefix it with the email address you used when creating your account on Luma website, like: `delaland+p1@adobetest.com - Purchase Journey`
- Click Save


## The Journey Canvas
The customer journey canvas is the central point for creating a real-time customer experience. The interface allows you to drag and drop three types of activities:
- Events: These are user actions (or actions generated by a third-party system) that arrive in real time in AEP, that you are willing to listen and react.
<img width="239" alt="image" src="https://github.com/user-attachments/assets/120fe95f-ca10-4bfd-99d0-6fdf9021a188" />

- Orchestration: Useful to apply filtering condition on the incoming population and to delay steps in a journey. The Read Audience activity lets you target an audience previously built, such as the _Luma - Blue Luma+ Members_ audience your profile automatically qualified previously.
<img width="240" alt="image" src="https://github.com/user-attachments/assets/89fc62b8-c1d6-49be-a97f-26011da7e035" />

- Actions: These are the different activities you can leverage to react and send communication to your customer. AJO comes with native activities to send personalized communications through inbound channels (website, in-app, kiosk, connected tvs) as well as outbound channels (email, sms, push notif). Of course you can build your own action if you have specific needs, like interacting with a proprietary channel (like exotic channels, ATM, call center, CRM systems etc)
<img width="239" alt="image" src="https://github.com/user-attachments/assets/ab456f4b-a054-4da3-9877-54595858a219" />


We will now personalize the Luma conversion path using a journey which will be composed of 2 branches, each one having its own business objective: 

- The Order Confirmation Branch to send a confirmation message to users who have complete their purchase. 
- The Abandoned Cart Branch to retarget Luma website users who have abandoned the purchase process.


---
# Create the Order Confirmation Branch

First, we're going to focus on the standard path, from checkout to purchase, which is the one customer are going to follow when they made an online purchase. Basically it consists in: 
- Listen to Checkout Event from the Luma website: This is the first page of the checkout process, where we ask Luma customer to validate their payment method and shipping details. 
- Listen to Purchase Event from Luma website: This is the second page of the checkout process, where we ask Luma customers to confirm their order.
- Get Information from Luma Loyalty System: This activity invokes an external API to retrieve offers based on the purchase value of the order.
- Send an order confirmation email: We'll craft the order from scratch leveraging AJO Digital Asset Manager, contextual information (like our promo code), content fragments and conditional content to make it even more relevant.

Our first branch will then look like this:
![image](https://github.com/user-attachments/assets/5ca5a717-4caa-44ef-9f87-5ec2e970b9ba)

The first event we are going to use to start the journey is triggered from the checkout page, when the user clicks on _Continue_ button. The event has been configured by the martech team and basically carries the information from the visitors session. You'll find in this event a json object representing the cart content (product name, price, quantity etc)  as well as the customers details. 
- Select the  _LumaCheckoutEvent_Email_ from the _EVENTS_ menu and drag and drop it to the canva.


The second event is triggered by the order summary, when the user clicks on _Confirm Order_ button. The event is also pre configured and ready to use. 
- Select the  _LumaPurchaseEvent_Email_ from the _EVENTS_ menu and drag and drop it to the canva, right after the first event. 
- 
- Select the _LoyaltyService_ from the _ACTIONS_ menu and drag and drop it to the canva
  - Now let's configure the request parameters of our custom action that will retrieve a promo code based on the purchase value. We have to send to the LoyaltyService API the customerId as well as the order value: 
    - In the _customerId_ input, select the attribute _@event{LumaPurchaseEvent_Email._aeppartner1.identification.core.email}_
    - In the _priceTotal_ input, select the attribute _@event{LumaPurchaseEvent_Email.productListItems.at(0).priceTotal}_
    - Click the _Save_ button
- Select the _Email_ activity from the _ACTIONS_ menu and drag and drop it to the canva. Notice  Tracking setting (clicks on email, email opens) is automatically enabled to enable feedback events in AEP real time customer profile 
    - Label the email _Order Confirmation Email_. It gives a name to your email delivery and will help you track its performance in the report
    - Under Email Configuration, select the _EmailMarketing_ value. It applies deliverability settings and email metadata (from, headers fields, tracking parameters) to the delivery


## Build the Order Confirmation Email 
- Click _Edit Content_ button. It opens the email editor where you can customize the content of the email


### Personalize the subject
Let's configure the subject line with our profile first name as personalisation token. 
- Click the ![image](https://github.com/user-attachments/assets/3ae69ec7-673b-4af9-b131-8dd1ef049189) icon and fetch the first name attribute of the real time customer profile (available at Profile attribute > Person > Full name), then click the ![image](https://github.com/user-attachments/assets/9364edca-5e09-4d3b-a7d9-cadf12213a88) icon to add it to the subject line, and append '_, your order confirmation_'
- Click _Save_


### Email Content 
Let's author the email body now. In the body section: 
- Click _Edit email body_. There are multiple options to build your communications, like using a template or create your own content. Here we are going to start from scractch
- Select _Build from scratch_
<img width="800" alt="image" src="https://github.com/user-attachments/assets/4d959630-f767-4e2d-9482-45ac9649cd35" />

- The Email editor opens up, you'll notice on the left rail a menu with sections to select pre-defined components, use AJO Assets, work with fragment and conditional content. There are plenty of helper you can leverage to speed up the email creation process.

- In Components > Structures > Select a 1:1 column

    
### Use Assets from AJO Digital Assets Manager
Adobe Journey Optimizer's Digital Asset Management (DAM) makes it easy to manage and optimize your content. You can upload images, remove backgrounds, and resize them using Adobe Express—all within the platform. Smart Tagging helps you find assets quickly, while version control keeps everything organized. Tasks streamline collaboration, and Renditions ensure assets are perfectly formatted for every channel. It’s a simple, efficient way to keep your creative work on track.For this lab, we're going to navigate to the DAM to upload a Luma logo, remove its colored background, resize it and add it to our email. 

- From the DAM menu icon, click on Collection, select the _Luma_ collection
- In Asset Selector > Collection > Select the Luma Collection, and drag'n'drop  the Luma logo in the first structure
- Resize to 60% and center-align the picture using the _Styles_ menu from the right hand rail

To play more with DAM feature, you can access it by clicking the 3 dots in the _Asset selector_ menu and select _Manage Assets_.
<img width="274" alt="image" src="https://github.com/user-attachments/assets/e72de355-4db5-43e9-9421-541ee31c6bb1" />


    
### Reuse with Fragments
Fragments are reusable, modular content pieces that can be incorporated into personalized messages. Fragments allow marketers to create content once and then reuse or adapt it across multiple campaigns and journeys without having to rebuild it each time. Let's use some previously created fragments to display the items that have been purchased. The fragment will leverage contextual data coming from the Luma Purchase Event that we added to the journey. 
- In Fragments, select the _Order Confirmation Text_
- In Components > Contents > add a Text content, and type _Here are the details of your order_ and click _Edit Personalization_ to get the content of the order.
- Under _Helper functions_, select _each_, then click _+_ sign and under Contextual attributes, look for _productListItems_.
- In the _each_ block, select Fragments  then click on the 3 dots besides _Order Content_ and select _Paste Fragment_
![image](https://github.com/user-attachments/assets/74be954b-c978-4e4e-aacd-d1331cf6e0dd)
- Click _Save_

    
### Make it Relevant with Conditional Content
Conditional content allows marketers to deliver highly personalized and dynamic messaging based on specific conditions or rules. Here, We want to invite customer who haven't the Luma Mobile App installed to do so. For the other, we'd like to promote the Luma+ Loyalty Program. We are going to leverage previously built platform audiences to manage this logic. 
- First, let's drag and drop a new container
- In Asset Selector > Collection > Select the Luma Collection, and choose the _Luma Loyalty +_ banner
- Add conditional content by clicking the ![image](https://github.com/user-attachments/assets/5de06ca6-7568-4e04-b4e9-66c4c0d0bdf5) icon and create another variant, name it: _Not Mobile App Users_ and edit a new condition by drag and dropping the audience _Luma Mobile App Users_, and switch the operator in the drop down to _does not include the audience_, then validate by clicking _Select_
![image](https://github.com/user-attachments/assets/3121d8ef-e349-4597-8eb9-f82ddcc44044)
- Update the image asset and select the _luma mobile app_ banner fromt the Asset selector.


### Enhance with with External Data
AJO custom actions are great to communicate with the outside world, whether it is to query external data sources and use its output to determine what do to next (like a condition in the journey to determine the next best path for our customer) or to contact an external system to push some personalized message (like creating a task to the shipping company). The capabilities are endless. In our Luma Purchase journey, we'd like to also incent our customers with an offer from our Loyalty System. It serves personalized Promo Code trough a REST API that we can query directly from the journey and use its response to personnalize further the email content based on the customer order value. 
- Add a new container _Text_ container in the email
- Click Edit Personalization, remove _Please type your text here._ and type instead _We selected this offer for you_, then under  _Contextual Attributes > Journey Orchestration > Actions > Loyalty Service_, select the _LoyaltyOffer_ attribute, then click _Save_.
![image](https://github.com/user-attachments/assets/7e1f26a2-c473-4371-bc47-1a0c9dfcd35a)


### Import the Footer Fragment
Time to finish our email with additional links which are embedded in every footer of Luma email communications. Let's add the _Luma - Footer Fragment_.
And you're donw with the order condirmation email. Of course, as a marketeer you can do much more, such as simulate content, check spam score, test its renditions, generate variants with genAI, send a proof etc. But so far you should have an email which looks like this, where personalization token automatically replaced during the email sendout. 
![image](https://github.com/user-attachments/assets/170efcef-004e-4d8f-913e-22fc1d561efd)

What we have so far is great, it covers the standard checkout process. Now AJO can do much more than that, let's spice the journey with a bit more intelligence to seamlessly reengage our cart abandoners if they stopped during the checkout process. 


---
# Build the Abandoned Cart Branch
We'd also like to retarget profiles who started the checkout process, but did not complete. Here what we're going to do: 
- Add a transition in case the Purchase Event did not arrive after a certain time
- Verify the customer preferred channel of communication
- Send a Push Notification through the mobile app to invite profile to resume his purchase or
- Send an Email with the content of the pending cart

Let's enhance the journey so it looks like this: 
![image](https://github.com/user-attachments/assets/35ae7e6f-f3e9-421e-8896-36f1ccd7bf07)


## Manage Event Timeout
The first thing to do is to detect when a customer dropped in the conversion process. AJO has a very neat way of managing profiles who did not move forward in the journey after a certain time. This is done through the _Timeout_ setting of the Event. You can define how long you want to wait for the event to occur, and if nothing happens you can direct your profiles to an alternate path, called the _timeout path_
- Click on the  _LumaPurchaseEvent_Email_, set a timeout for let's say, 1 minute (of course, it would be much longer outside of this lab) and click _Set a timeout path_
  ![image](https://github.com/user-attachments/assets/6d71935c-71f2-4ffb-97d8-0a0d6530aea4)
- Select the _Condition_ activity from the _ORCHESTRATION_ menu and drag and drop it to the canva
  - Label the activity _Preferred Channel_ and select Type _Data source condition_
  - The first path will be for Luma users who have consented to receive Mobile Push. Click on the ![image](https://github.com/user-attachments/assets/9c9237c5-9846-42f4-b6ab-799aa62e1864) icon to edit the expression. Here let's select unders _Audiences_  _Luma - Mobile App Users_
  - Label this Path _Push_
  - Select the Show path for other cases than the one(s) above and label it _Others_ for profiles who want to be targeted throuh other channels
    ![image](https://github.com/user-attachments/assets/76161593-67c8-47cc-8637-2eb780a60c3d)

## Be friend with Content Templates 
Content Template is a nice addition in AJO, it makes it easy for marketers and content managers to build highly-reusable content, outside of any campaign or journeys. It offers powerful features such as the ability to lock certain area of the template to prevent unintentional edits or deletions, giving you greater control over template customization, and improving the efficiency and reliability of your email campaigns.

- Select the _Push_ activity from the _ACTIONS_ menu and drag and drop it to the canva and connect it to the _Push_ transition of your condition activity
  - Label the push _Abandoned Cart Push_. It gives a name to your email delivery and will help you track its performance in the report
  - Under Push Configuration, select DXDemoApp
  Click _Edit content_ button
  - Let's use a predefined Push template that has been configured previously: Click Apply content template from the Content Template button
    - In the _Saved Template_ tab, Select _Luma - Abandoned Push_ content template and click _Confirm_
    - Notice how the iOS and Android content get automtically applied from the template. You can still edit them to match your specific purpose. 
      
- Lets go back to the journey and Select the _Email_ activity from the _ACTIONS_ menu and drag and drop it to the canva and onnect it to the _Others_ transition of your condition activity
    - Label the email _Abandoned Cart Email_. It gives a name to your email delivery and will help you track its performance in the report
    - Under Email Configuration, select the _EmailMarketing_ value.
    - Click Edit content
    - Let's use a predefined Email template that has been configured previously: Click Apply content template from the Content Template button
    - In the _Saved Template_ tab, Select _Luma - Cart Abandoned Email_ content template and click _Confirm_

<img width="558" alt="image" src="https://github.com/user-attachments/assets/48a3bec6-5bc1-46ce-906f-a06646872bc6" />

 

## Use Automated Translations in your messages
We'd like this email to be automatically translated based on the preferred language of the profile. We are going to use Microsfot automatic translation service to provide Spanish and French version of the email content. 
  - Click Add languages, select _Luma_Language_Settings_, then click _Select_
  - Notice 3 locales loaded
  - Click Send to translation, the translation is in progress. It usually takes a couple of minutes to complete. You can monitor the translation process in the Translation project tab ![image](https://github.com/user-attachments/assets/616c4415-85e0-409d-a853-273a9afcc28b). Feel free to reload the browser tab to refresh the variant.

<img width="266" alt="image" src="https://github.com/user-attachments/assets/07f7348f-4e16-43e5-85ba-3aae9bb65853" />



## Apply Frequency Capping
Email retargeting can be quickly overwhelming for customers. To avoid sursollicitating our Luma customers with too many communications, we should apply business rules that limit the number of communication to send over a specific period of time.  In our case, we want to enforce a cross channel rule that limits the number of emails and pushs to 3 retargeting message per week. The rule has already been created as follow. 

![image](https://github.com/user-attachments/assets/0307c3ee-207a-4e35-915c-79a83e7006ce)

What you'll have to do is to apply this rule to your message
- Click _Business Rule_, select _Luma Marketing  - Outgoing messages_ Rue Set, then click _Save_


---
# Finalize the Journey
We're almost done with the journey, just a couple of steps more to tie the abandoned branch back to the order confirmation branch. Once our profile receive the retargeting message, he is invited to resume its purchase. When doing so, he will generate a new Purchase Event that AJO is going to listen in order to complete the purchase process
- Select the _LumaPurchaseEvent_Email_ from the _EVENTS_ menu and drag and drop it to the canva
- Mov the Push and Email outgoing path to the above event to connect them altogether
- Link the outgoing path of the _LumaPurchaseEvent_Email1_ to the LoyaltyService action
Your journey should now look like this:
![image](https://github.com/user-attachments/assets/15e171c8-181e-4285-9658-1886ac4229fa)


## Test the journey
Whether you completed the whole journey or not, you can test the end to end customer experience by yourself. There is a published a [_Luma - Purchase Journey_]([url](https://experience.adobe.com/#/@aeppartner1/sname:ajoacademya/journey-optimizer/journeys/journey/6d13f13c-2065-4f7c-9e25-c795bf6d978b)), where you can track the entries. 
- Return to the Luma website, add an item to your cart, and click the _Shopping Cart_ button in the top right corner of the interface. Click the _Checkout_ button, then _Continue_.
- Do not confirm the order yet. The journey is configured to send the cart abandonment email after one minute of inactivity. 
- In the meantime, return to Journey Optimizer and view your user's progress through the customer journey.

The profile abandoned its cart, and AJO routes him to the abandoned cart branch:

![image](https://github.com/user-attachments/assets/a178d0b0-b11b-44d8-9145-25baa9e666d8)


After a given period of inactivity, the user is considered to have abandoned the purchase process, and the email you previously configured is sent with a link to revalidate their cart. Go to your email client and click on the link in the new email received. This will take you back to the cart, where you can complete your purchase online.


The Abandoned Cart Email:

![image](https://github.com/user-attachments/assets/18b1228b-16bb-4397-ad82-efac41600236)


The Order Confirmation Email:

![image](https://github.com/user-attachments/assets/0b915215-bf21-4b26-9cf9-7dc870d2b9c7)


## Journey Reporting
As a marketeer, we want to keep track of the [_Luma - Purchase Journey_]([url](https://experience.adobe.com/#/@aeppartner1/sname:ajoacademya/journey-optimizer/journeys/journey/6d13f13c-2065-4f7c-9e25-c795bf6d978b)) performance. The AJO reporting UI displays essential metrics associated with your journey. This encompasses details such as the count of entered profiles and instances of failed individual journeys, offering a comprehensive insight into your journey’s effectiveness and level of engagement. Journey report can be accessed directly from your journey with the _View report_ button.

![image](https://github.com/user-attachments/assets/31a06968-0b6c-4982-8083-03ab30a0ace2)


## Package your journey and share it
Our journey is complete and live, it works so well that we want to reuse it in another context. Rolling out AJO objets (journeys, campaigns, content template, audiences etc) is easy thanks to Packages. 
You can seamlessly export and import AJO configurations between AEP environments, whether it is across different sandboxes or across different organisation. With packages, you reduce the time to value for the implementation process and move successful configurations in a few clicks.

A package can consist of a single object or multiple objects, for this lab, we are going to package the journey you built so you can reuse it in your own partner organisation. 

- Click on the 3 dots besides your journey, then Add to package
- Select Create new package, name it  _Purchase Journey Package_, please prefix it with the email address you used when creating your account on Luma website, like: `delaland+p1@adobetest.com - Purchase Journey Package`
- Click _Add_ button
- Go to Administration > Sandboxes > Packages and click on your newly created package, click _Publish_ and confirm. The publication process takes a few seconds. 
- Once published, click on 3 dots beside your package and select the option  _Update to public package_ and _Confirm_ 
- Click again on the 3 dots beside your package and select _Copy package payload_
- You can now switch to your partner instance and import the package using this payload !

![image](https://github.com/user-attachments/assets/1f7742e8-7880-4d24-a77a-e49d033ddf54)
![image](https://github.com/user-attachments/assets/88694969-9ecd-4419-bd34-7b9e15c21b11)


---

Congratulations! You have completed the second chapter of the lab 👍 ✨ 🎉, go to the [next step](campaign.md) or return to the [home](README.md)
